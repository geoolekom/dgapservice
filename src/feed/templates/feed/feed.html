{% extends "core/base.html" %}
{% load bootstrap3 %}

{% block title %} Newsfeed {% endblock %}

{% block content %}

	{% if object_list.count != 0 %}

		<div class="row blocked header">
			<div class="col-sm-8">
				<form class="form-inline">
					<div class="form-group">
						<select class="form-control" id="sort" name="sort">
							<option value="1">По дате добавления</option>
							<option value="2">По рейтингу</option>
						</select>
						<button class="btn btn-link"><span class="glyphicon glyphicon-filter"></span></button>
					</div>
				</form>
			</div>
			<div class="col-sm-1">
				{% if user.is_staff %}
					<a href="{% url 'feed:add_post' %}" class="btn btn-link"><span class="glyphicon glyphicon-plus"></a>
				{% endif %}
			</div>
			<div class="col-sm-3">
				<form class="form-horizontal">
					<div class="form-group">
						<input type="text" class="form-control" name="searchstr" placeholder="Поиск" val="" id="srch">
					</div>
				</form>
			</div>
		</div>

		<div class="row">
			<div class="col-sm-12">
				<div class="panel-group">
					{% for post in object_list %}
					<div class="panel panel-default">
						<div class="panel-heading blocked post-title">
							<div class="row">
								<div class="col-sm-1" align="center">
									{% if user.is_staff and post.author == user %}
									<p> </p>
										<form method="post" class="form-inline">
											{% csrf_token %}
											<input type="text" name="mypost" value="{{post.id}}" hidden>
											<div class="dropdown">
												<button class="btn btn-link btn-lg dropdown-toggle" type="button" data-toggle="dropdown">
													<span class="glyphicon glyphicon-chevron-down"></span>
												</button>
												<ul class="dropdown-menu">
													<li>
														<button formaction="delete" class="btn btn-link">
															<span class="glyphicon glyphicon-remove">  Удалить</span>
														</button>
													</li>
													<li>
														<button formaction="edit-post" class="btn btn-link">
															<span class="glyphicon glyphicon-pencil">  Редактировать</span>
														</button>
													</li>
												</ul>
											</div>
										</form>
									{% endif %}
								</div>
								<div class="col-sm-9">
									<a href="{% url 'feed:detail' post.id %}"> <h2> {{ post.title }} </h2></a>
								</div>
								<div class="col-sm-1 post-rating" align="right"> <b> {{ post.rating }} </b> </div>
								<div class="col-sm-1" align="right">  {% include 'feed/rate_form.html' %}  </div>
							</div>
						</div>
						<div class="panel-body">
							<p> {{ post.summary | safe }} </p>
						</div>
					</div>
					{% endfor %}
				</div>
			</div>
		</div>

	{% else %}
		<div class="row">
			<div class="col-sm-9">
				<div class="header"> <h2> Нет подходящих постов. </h2> </div>
			</div>
			<div class="col-sm-3">
				<form class="form form-inline">
					<input type="text" class="form-control" placeholder="Поиск"  name="searchstr" val="">
				</form>
			</div>
		</div>
	{% endif %}

{% endblock %}